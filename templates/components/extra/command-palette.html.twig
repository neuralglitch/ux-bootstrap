{% apply spaceless -%}

  {% set o = this.options() %}

  {# Modal structure #}
  <div class="{{ o.modalClasses }}" {{ this.renderHtmlAttributes(o.attrs) | raw }}>
    <div class="{{ o.dialogClasses }}">
      <div class="modal-content command-palette-content">
        
        {# Search Input #}
        <div class="command-palette-search">
          <div class="command-palette-search-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
          </div>
          <input
            type="text"
            class="command-palette-input"
            placeholder="{{ o.placeholder }}"
            data-bs-command-palette-target="input"
            data-action="input->bs-command-palette#handleInput keydown->bs-command-palette#handleKeydown"
            autocomplete="off"
            spellcheck="false"
          />
          <div class="command-palette-trigger-hint">
            <kbd>
              {% if o.triggerMeta %}
                <twig:ux:icon name="mdi:apple-keyboard-command" /> + 
              {% endif %}
              {% if o.triggerCtrl %}
                Ctrl +
              {% endif %}
              {% if o.triggerShift %}
                Shift + 
              {% endif %}
              {% if o.triggerAlt %}
                Alt + 
              {% endif %}
              {{ o.triggerKey|upper }}
            </kbd>
          </div>
        </div>

        {# Loading Spinner #}
        <div class="command-palette-loading" data-bs-command-palette-target="loading" style="display: none;">
          <div class="spinner-border spinner-border-sm text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        {# Results Container #}
        <div class="command-palette-results" data-bs-command-palette-target="results">
          
          {# Recent Commands (shown initially if enabled) #}
          {% if o.showRecent %}
          <div class="command-palette-section" data-bs-command-palette-target="recentSection">
            <div class="command-palette-section-header">
              <span class="command-palette-section-title">Recent</span>
            </div>
            <div class="command-palette-list" data-bs-command-palette-target="recentList">
              {# Recent items will be dynamically rendered here #}
            </div>
          </div>
          {% endif %}

          {# Empty State #}
          <div class="command-palette-empty" data-bs-command-palette-target="empty" style="display: none;">
            <twig:ux:icon name="bi:inbox"/>
            <p>{{ o.emptyMessage }}</p>
          </div>

          {# Command Groups Container #}
          <div data-bs-command-palette-target="groups"></div>
          
        </div>

        {# Footer with hints #}
        <div class="command-palette-footer">
          <div class="command-palette-hints">
            <span class="command-palette-hint"><kbd><twig:ux:icon name="bi:arrow-up" /></kbd><kbd><twig:ux:icon name="bi:arrow-down" /></kbd> Navigate</span>
            <span class="command-palette-hint"><kbd><twig:ux:icon name="bi:arrow-return-left" /></kbd> Select</span>
            <span class="command-palette-hint"><kbd><twig:ux:icon name="mdi:keyboard-esc" /></kbd> Close</span>
          </div>
        </div>

      </div>
    </div>
  </div>

{%- endapply %}

